Base config: BaseConfig(epochs=20, num_workers=16, debug=False, data_filename='data/reports/reports_sampled_no_conclusion.csv', root='.', target_label='Report', datapoint_loc_label='FileName', frames=16, stride=2, multi_video=True, num_videos=4, groupby_column='StudyInstanceUID', shuffle_videos=True, model_name='mvit', pretrained=True, output_dir='outputs', seed=42, use_amp=True, device='cuda', period=1, recall_k=[1, 5, 10], ndcg_k=[5], rand_augment=True, resize=224, apply_mask=False, view_count=None, save_best='loss', resume_training=False, checkpoint='outputs/deepCORO_CLIP/DeepCORO_Clip_Sweep_Learnable_Temp_Full_mvit_b12_f16_RAdam_lr0.0001_20250114-190320_2o5xoevj/checkpoints/latest.pt')
Sweep config: SweepConfig(batch_size=10, lr=3.5377348478243525e-05, optimizer='AdamW', scheduler_type='cosine', lr_step_period=10, factor=0.4664699082704683, weight_decay=2.736160276516216e-05, loss_name='contrastive', temperature=0.09929340444103917, dropout=0.22800667131723476, video_freeze_ratio=0.7763673151375725, text_freeze_ratio=0.8593969366167069, num_heads=2, aggregator_depth=3, tag='mvit_pretrained', name='dev_deep_coro_clip', project='dev_deep_coro_clip', entity='mhi_ai')
HeartWise config: HeartWiseConfig(lr=3.5377348478243525e-05, batch_size=10, epochs=20, num_workers=16, debug=False, temperature=0.09929340444103917, data_filename='data/reports/reports_sampled_no_conclusion.csv', root='.', target_label='Report', datapoint_loc_label='FileName', frames=16, stride=2, multi_video=True, num_videos=4, groupby_column='StudyInstanceUID', shuffle_videos=True, model_name='mvit', pretrained=True, video_freeze_ratio=0.7763673151375725, text_freeze_ratio=0.8593969366167069, dropout=0.22800667131723476, num_heads=2, aggregator_depth=3, optimizer='AdamW', scheduler_type='cosine', lr_step_period=10, factor=0.4664699082704683, weight_decay=2.736160276516216e-05, output_dir='outputs', seed=42, use_amp=True, device='cuda', period=1, loss_name='contrastive', recall_k=[1, 5, 10], ndcg_k=[5], rand_augment=True, resize=224, apply_mask=False, view_count=None, save_best='loss', resume_training=False, checkpoint='outputs/deepCORO_CLIP/DeepCORO_Clip_Sweep_Learnable_Temp_Full_mvit_b12_f16_RAdam_lr0.0001_20250114-190320_2o5xoevj/checkpoints/latest.pt', tag='mvit_pretrained', name='dev_deep_coro_clip', project='dev_deep_coro_clip', entity='mhi_ai')
running main with gpu 0
("Config: {'lr': 3.5377348478243525e-05, 'batch_size': 10, 'epochs': 20, "
 "'num_workers': 16, 'debug': False, 'temperature': 0.09929340444103917, "
 "'data_filename': 'data/reports/reports_sampled_no_conclusion.csv', 'root': "
 "'.', 'target_label': 'Report', 'datapoint_loc_label': 'FileName', 'frames': "
 "16, 'stride': 2, 'multi_video': True, 'num_videos': 4, 'groupby_column': "
 "'StudyInstanceUID', 'shuffle_videos': True, 'model_name': 'mvit', "
 "'pretrained': True, 'video_freeze_ratio': 0.7763673151375725, "
 "'text_freeze_ratio': 0.8593969366167069, 'dropout': 0.22800667131723476, "
 "'num_heads': 2, 'aggregator_depth': 3, 'optimizer': 'AdamW', "
 "'scheduler_type': 'cosine', 'lr_step_period': 10, 'factor': "
 "0.4664699082704683, 'weight_decay': 2.736160276516216e-05, 'output_dir': "
 "'outputs', 'seed': 42, 'use_amp': True, 'device': 'cuda', 'period': 1, "
 "'loss_name': 'contrastive', 'recall_k': [1, 5, 10], 'ndcg_k': [5], "
 "'rand_augment': True, 'resize': 224, 'apply_mask': False, 'view_count': "
 "None, 'save_best': 'loss', 'resume_training': False, 'checkpoint': "
 "'outputs/deepCORO_CLIP/DeepCORO_Clip_Sweep_Learnable_Temp_Full_mvit_b12_f16_RAdam_lr0.0001_20250114-190320_2o5xoevj/checkpoints/latest.pt', "
 "'tag': 'mvit_pretrained', 'name': 'dev_deep_coro_clip', 'project': "
 "'dev_deep_coro_clip', 'entity': 'mhi_ai'}")

=== Calculating Dataset Statistics ===
Frame count per video: 16

Dataset Statistics:
Mean: [101.12091064453125, 101.12091064453125, 101.12091064453125]
Std:  [39.847476959228516, 39.847476959228516, 39.847476959228516]
===========================

f0a85bca3128:83128:83128 [0] NCCL INFO Bootstrap : Using eth0:172.17.0.2<0>
f0a85bca3128:83128:83128 [0] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
f0a85bca3128:83128:83128 [0] NCCL INFO NET/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-net.so
f0a85bca3128:83128:83128 [0] NCCL INFO NET/Plugin: Using internal network plugin.
f0a85bca3128:83128:83128 [0] NCCL INFO cudaDriverVersion 12040
NCCL version 2.21.5+cuda12.4
f0a85bca3128:83128:85890 [0] NCCL INFO Failed to open libibverbs.so[.1]
f0a85bca3128:83128:85890 [0] NCCL INFO NET/Socket : Using [0]eth0:172.17.0.2<0>
f0a85bca3128:83128:85890 [0] NCCL INFO Using non-device net plugin version 0
f0a85bca3128:83128:85890 [0] NCCL INFO Using network Socket
f0a85bca3128:83128:85890 [0] NCCL INFO ncclCommInitRank comm 0x55cce1764920 rank 0 nranks 1 cudaDev 0 nvmlDev 0 busId 1000 commId 0xec867e2e50224f6e - Init START
f0a85bca3128:83128:85890 [0] NCCL INFO Setting affinity for GPU 0 to ff000000,00000000,ff000000
f0a85bca3128:83128:85890 [0] NCCL INFO comm 0x55cce1764920 rank 0 nRanks 1 nNodes 1 localRanks 1 localRank 0 MNNVL 0
f0a85bca3128:83128:85890 [0] NCCL INFO Channel 00/32 :    0
f0a85bca3128:83128:85890 [0] NCCL INFO Channel 01/32 :    0
f0a85bca3128:83128:85890 [0] NCCL INFO Channel 02/32 :    0
f0a85bca3128:83128:85890 [0] NCCL INFO Channel 03/32 :    0
f0a85bca3128:83128:85890 [0] NCCL INFO Channel 04/32 :    0
f0a85bca3128:83128:85890 [0] NCCL INFO Channel 05/32 :    0
f0a85bca3128:83128:85890 [0] NCCL INFO Channel 06/32 :    0
f0a85bca3128:83128:85890 [0] NCCL INFO Channel 07/32 :    0
f0a85bca3128:83128:85890 [0] NCCL INFO Channel 08/32 :    0
f0a85bca3128:83128:85890 [0] NCCL INFO Channel 09/32 :    0
f0a85bca3128:83128:85890 [0] NCCL INFO Channel 10/32 :    0
f0a85bca3128:83128:85890 [0] NCCL INFO Channel 11/32 :    0
f0a85bca3128:83128:85890 [0] NCCL INFO Channel 12/32 :    0
f0a85bca3128:83128:85890 [0] NCCL INFO Channel 13/32 :    0
f0a85bca3128:83128:85890 [0] NCCL INFO Channel 14/32 :    0
f0a85bca3128:83128:85890 [0] NCCL INFO Channel 15/32 :    0
f0a85bca3128:83128:85890 [0] NCCL INFO Channel 16/32 :    0
f0a85bca3128:83128:85890 [0] NCCL INFO Channel 17/32 :    0
f0a85bca3128:83128:85890 [0] NCCL INFO Channel 18/32 :    0
f0a85bca3128:83128:85890 [0] NCCL INFO Channel 19/32 :    0
f0a85bca3128:83128:85890 [0] NCCL INFO Channel 20/32 :    0
f0a85bca3128:83128:85890 [0] NCCL INFO Channel 21/32 :    0
f0a85bca3128:83128:85890 [0] NCCL INFO Channel 22/32 :    0
f0a85bca3128:83128:85890 [0] NCCL INFO Channel 23/32 :    0
f0a85bca3128:83128:85890 [0] NCCL INFO Channel 24/32 :    0
f0a85bca3128:83128:85890 [0] NCCL INFO Channel 25/32 :    0
f0a85bca3128:83128:85890 [0] NCCL INFO Channel 26/32 :    0
f0a85bca3128:83128:85890 [0] NCCL INFO Channel 27/32 :    0
f0a85bca3128:83128:85890 [0] NCCL INFO Channel 28/32 :    0
f0a85bca3128:83128:85890 [0] NCCL INFO Channel 29/32 :    0
f0a85bca3128:83128:85890 [0] NCCL INFO Channel 30/32 :    0
f0a85bca3128:83128:85890 [0] NCCL INFO Channel 31/32 :    0
f0a85bca3128:83128:85890 [0] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
f0a85bca3128:83128:85890 [0] NCCL INFO P2P Chunksize set to 131072
f0a85bca3128:83128:85890 [0] NCCL INFO Connected all rings
f0a85bca3128:83128:85890 [0] NCCL INFO Connected all trees
f0a85bca3128:83128:85890 [0] NCCL INFO 32 coll channels, 32 collnet channels, 0 nvls channels, 32 p2p channels, 32 p2p channels per peer
f0a85bca3128:83128:85890 [0] NCCL INFO TUNER/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-tuner.so
f0a85bca3128:83128:85890 [0] NCCL INFO TUNER/Plugin: Using internal tuner plugin.
f0a85bca3128:83128:85890 [0] NCCL INFO ncclCommInitRank comm 0x55cce1764920 rank 0 nranks 1 cudaDev 0 nvmlDev 0 busId 1000 commId 0xec867e2e50224f6e - Init COMPLETE
Rank: 0 - mean: tensor([101.1209, 101.1209, 101.1209]) - std: tensor([39.8475, 39.8475, 39.8475])
[MultiVideoDataset] resize=224
[MultiVideoDataset] mean=[101.12091064453125, 101.12091064453125, 101.12091064453125]
[MultiVideoDataset] std=[39.847476959228516, 39.847476959228516, 39.847476959228516]
[MultiVideoDataset] shuffle_videos=True
[MultiVideoDataset] seed=42
[MultiVideoDataset] seed=42 for random video sampling
[MultiVideoDataset] Found 31286 studies in split='train'
[MultiVideoDataset] Missing 0 studies in split='train'
[MultiVideoDataset] resize=224
[MultiVideoDataset] mean=[101.12091064453125, 101.12091064453125, 101.12091064453125]
[MultiVideoDataset] std=[39.847476959228516, 39.847476959228516, 39.847476959228516]
[MultiVideoDataset] shuffle_videos=True
[MultiVideoDataset] seed=42
[MultiVideoDataset] seed=42 for random video sampling
[MultiVideoDataset] Found 3463 studies in split='val'
[MultiVideoDataset] Missing 0 studies in split='val'

=== Dataset Information ===
Training:   3,128 batches per GPU
Validation: 347 batches per GPU
Total:      3,475 batches per GPU

Batch Size: 10
Training: 31,280 videos per GPU
Validation: 3,470 videos per GPU
Total: 34,750 videos per GPU
===========================

Saved 3463 val texts to outputs/dev_deep_coro_clip/mvit_pretrained_mvit_b10_f16_AdamW_lr3.5377348478243525e-05_20250204-171909_jc3j18rc/val_texts.csv

New best model! Val Loss: 2.2991 (previous: inf)

Saved best checkpoint at epoch 1

Saved latest checkpoint at epoch 1

Saved latest checkpoint at epoch 2

Saved latest checkpoint at epoch 3
