Base config: BaseConfig(epochs=20, num_workers=16, debug=False, data_filename='data/reports/reports_sampled.csv', root='.', target_label='Report', datapoint_loc_label='FileName', frames=16, stride=2, multi_video=True, num_videos=4, groupby_column='StudyInstanceUID', shuffle_videos=True, model_name='mvit', pretrained=True, output_dir='outputs', seed=42, use_amp=True, device='cuda', period=1, recall_k=[1, 5, 10], ndcg_k=[5], rand_augment=True, resize=224, apply_mask=False, view_count=None, save_best='loss', resume_training=False, checkpoint='outputs/deepCORO_CLIP/DeepCORO_Clip_Sweep_Learnable_Temp_Full_mvit_b12_f16_RAdam_lr0.0001_20250114-190320_2o5xoevj/checkpoints/latest.pt')
Sweep config: SweepConfig(batch_size=10, lr=0.0001, optimizer='RAdam', scheduler_type='step', lr_step_period=15, factor=0.3, weight_decay=1e-06, loss_name='contrastive', temperature=0.07, dropout=0.2, video_freeze_ratio=0.8, text_freeze_ratio=0.95, num_heads=2, aggregator_depth=2, tag='mvit_pretrained', name='dev_deep_coro_clip', project='dev_deep_coro_clip', entity='mhi_ai')
HeartWise config: HeartWiseConfig(lr=0.0001, batch_size=10, epochs=20, num_workers=16, debug=False, temperature=0.07, data_filename='data/reports/reports_sampled.csv', root='.', target_label='Report', datapoint_loc_label='FileName', frames=16, stride=2, multi_video=True, num_videos=4, groupby_column='StudyInstanceUID', shuffle_videos=True, model_name='mvit', pretrained=True, video_freeze_ratio=0.8, text_freeze_ratio=0.95, dropout=0.2, num_heads=2, aggregator_depth=2, optimizer='RAdam', scheduler_type='step', lr_step_period=15, factor=0.3, weight_decay=1e-06, output_dir='outputs', seed=42, use_amp=True, device='cuda', period=1, loss_name='contrastive', recall_k=[1, 5, 10], ndcg_k=[5], rand_augment=True, resize=224, apply_mask=False, view_count=None, save_best='loss', resume_training=False, checkpoint='outputs/deepCORO_CLIP/DeepCORO_Clip_Sweep_Learnable_Temp_Full_mvit_b12_f16_RAdam_lr0.0001_20250114-190320_2o5xoevj/checkpoints/latest.pt', tag='mvit_pretrained', name='dev_deep_coro_clip', project='dev_deep_coro_clip', entity='mhi_ai')
running main with gpu 0
Base config: BaseConfig(epochs=20, num_workers=16, debug=False, data_filename='data/reports/reports_sampled.csv', root='.', target_label='Report', datapoint_loc_label='FileName', frames=16, stride=2, multi_video=True, num_videos=4, groupby_column='StudyInstanceUID', shuffle_videos=True, model_name='mvit', pretrained=True, output_dir='outputs', seed=42, use_amp=True, device='cuda', period=1, recall_k=[1, 5, 10], ndcg_k=[5], rand_augment=True, resize=224, apply_mask=False, view_count=None, save_best='loss', resume_training=False, checkpoint='outputs/deepCORO_CLIP/DeepCORO_Clip_Sweep_Learnable_Temp_Full_mvit_b12_f16_RAdam_lr0.0001_20250114-190320_2o5xoevj/checkpoints/latest.pt')
Sweep config: SweepConfig(batch_size=10, lr=0.0001, optimizer='RAdam', scheduler_type='step', lr_step_period=15, factor=0.3, weight_decay=1e-06, loss_name='contrastive', temperature=0.07, dropout=0.2, video_freeze_ratio=0.8, text_freeze_ratio=0.95, num_heads=2, aggregator_depth=2, tag='mvit_pretrained', name='dev_deep_coro_clip', project='dev_deep_coro_clip', entity='mhi_ai')
HeartWise config: HeartWiseConfig(lr=0.0001, batch_size=10, epochs=20, num_workers=16, debug=False, temperature=0.07, data_filename='data/reports/reports_sampled.csv', root='.', target_label='Report', datapoint_loc_label='FileName', frames=16, stride=2, multi_video=True, num_videos=4, groupby_column='StudyInstanceUID', shuffle_videos=True, model_name='mvit', pretrained=True, video_freeze_ratio=0.8, text_freeze_ratio=0.95, dropout=0.2, num_heads=2, aggregator_depth=2, optimizer='RAdam', scheduler_type='step', lr_step_period=15, factor=0.3, weight_decay=1e-06, output_dir='outputs', seed=42, use_amp=True, device='cuda', period=1, loss_name='contrastive', recall_k=[1, 5, 10], ndcg_k=[5], rand_augment=True, resize=224, apply_mask=False, view_count=None, save_best='loss', resume_training=False, checkpoint='outputs/deepCORO_CLIP/DeepCORO_Clip_Sweep_Learnable_Temp_Full_mvit_b12_f16_RAdam_lr0.0001_20250114-190320_2o5xoevj/checkpoints/latest.pt', tag='mvit_pretrained', name='dev_deep_coro_clip', project='dev_deep_coro_clip', entity='mhi_ai')
running main with gpu 2
Base config: BaseConfig(epochs=20, num_workers=16, debug=False, data_filename='data/reports/reports_sampled.csv', root='.', target_label='Report', datapoint_loc_label='FileName', frames=16, stride=2, multi_video=True, num_videos=4, groupby_column='StudyInstanceUID', shuffle_videos=True, model_name='mvit', pretrained=True, output_dir='outputs', seed=42, use_amp=True, device='cuda', period=1, recall_k=[1, 5, 10], ndcg_k=[5], rand_augment=True, resize=224, apply_mask=False, view_count=None, save_best='loss', resume_training=False, checkpoint='outputs/deepCORO_CLIP/DeepCORO_Clip_Sweep_Learnable_Temp_Full_mvit_b12_f16_RAdam_lr0.0001_20250114-190320_2o5xoevj/checkpoints/latest.pt')
Sweep config: SweepConfig(batch_size=10, lr=0.0001, optimizer='RAdam', scheduler_type='step', lr_step_period=15, factor=0.3, weight_decay=1e-06, loss_name='contrastive', temperature=0.07, dropout=0.2, video_freeze_ratio=0.8, text_freeze_ratio=0.95, num_heads=2, aggregator_depth=2, tag='mvit_pretrained', name='dev_deep_coro_clip', project='dev_deep_coro_clip', entity='mhi_ai')
HeartWise config: HeartWiseConfig(lr=0.0001, batch_size=10, epochs=20, num_workers=16, debug=False, temperature=0.07, data_filename='data/reports/reports_sampled.csv', root='.', target_label='Report', datapoint_loc_label='FileName', frames=16, stride=2, multi_video=True, num_videos=4, groupby_column='StudyInstanceUID', shuffle_videos=True, model_name='mvit', pretrained=True, video_freeze_ratio=0.8, text_freeze_ratio=0.95, dropout=0.2, num_heads=2, aggregator_depth=2, optimizer='RAdam', scheduler_type='step', lr_step_period=15, factor=0.3, weight_decay=1e-06, output_dir='outputs', seed=42, use_amp=True, device='cuda', period=1, loss_name='contrastive', recall_k=[1, 5, 10], ndcg_k=[5], rand_augment=True, resize=224, apply_mask=False, view_count=None, save_best='loss', resume_training=False, checkpoint='outputs/deepCORO_CLIP/DeepCORO_Clip_Sweep_Learnable_Temp_Full_mvit_b12_f16_RAdam_lr0.0001_20250114-190320_2o5xoevj/checkpoints/latest.pt', tag='mvit_pretrained', name='dev_deep_coro_clip', project='dev_deep_coro_clip', entity='mhi_ai')
running main with gpu 1
("Config: {'lr': 0.0001, 'batch_size': 10, 'epochs': 20, 'num_workers': 16, "
 "'debug': False, 'temperature': 0.07, 'data_filename': "
 "'data/reports/reports_sampled.csv', 'root': '.', 'target_label': 'Report', "
 "'datapoint_loc_label': 'FileName', 'frames': 16, 'stride': 2, 'multi_video': "
 "True, 'num_videos': 4, 'groupby_column': 'StudyInstanceUID', "
 "'shuffle_videos': True, 'model_name': 'mvit', 'pretrained': True, "
 "'video_freeze_ratio': 0.8, 'text_freeze_ratio': 0.95, 'dropout': 0.2, "
 "'num_heads': 2, 'aggregator_depth': 2, 'optimizer': 'RAdam', "
 "'scheduler_type': 'step', 'lr_step_period': 15, 'factor': 0.3, "
 "'weight_decay': 1e-06, 'output_dir': 'outputs', 'seed': 42, 'use_amp': True, "
 "'device': 'cuda', 'period': 1, 'loss_name': 'contrastive', 'recall_k': [1, "
 "5, 10], 'ndcg_k': [5], 'rand_augment': True, 'resize': 224, 'apply_mask': "
 "False, 'view_count': None, 'save_best': 'loss', 'resume_training': False, "
 "'checkpoint': "
 "'outputs/deepCORO_CLIP/DeepCORO_Clip_Sweep_Learnable_Temp_Full_mvit_b12_f16_RAdam_lr0.0001_20250114-190320_2o5xoevj/checkpoints/latest.pt', "
 "'tag': 'mvit_pretrained', 'name': 'dev_deep_coro_clip', 'project': "
 "'dev_deep_coro_clip', 'entity': 'mhi_ai'}")
f0a85bca3128:84379:84379 [0] NCCL INFO Bootstrap : Using eth0:172.17.0.2<0>
f0a85bca3128:84379:84379 [0] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
f0a85bca3128:84379:84379 [0] NCCL INFO NET/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-net.so
f0a85bca3128:84379:84379 [0] NCCL INFO NET/Plugin: Using internal network plugin.
f0a85bca3128:84379:84379 [0] NCCL INFO cudaDriverVersion 12040
NCCL version 2.21.5+cuda12.4
f0a85bca3128:84381:84381 [2] NCCL INFO cudaDriverVersion 12040
f0a85bca3128:84381:84381 [2] NCCL INFO Bootstrap : Using eth0:172.17.0.2<0>
f0a85bca3128:84381:84381 [2] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
f0a85bca3128:84381:84381 [2] NCCL INFO NET/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-net.so
f0a85bca3128:84381:84381 [2] NCCL INFO NET/Plugin: Using internal network plugin.
f0a85bca3128:84380:84380 [1] NCCL INFO cudaDriverVersion 12040
f0a85bca3128:84380:84380 [1] NCCL INFO Bootstrap : Using eth0:172.17.0.2<0>
f0a85bca3128:84380:84380 [1] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
f0a85bca3128:84380:84380 [1] NCCL INFO NET/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-net.so
f0a85bca3128:84380:84380 [1] NCCL INFO NET/Plugin: Using internal network plugin.
f0a85bca3128:84379:84574 [0] NCCL INFO Failed to open libibverbs.so[.1]
f0a85bca3128:84379:84574 [0] NCCL INFO NET/Socket : Using [0]eth0:172.17.0.2<0>
f0a85bca3128:84379:84574 [0] NCCL INFO Using non-device net plugin version 0
f0a85bca3128:84379:84574 [0] NCCL INFO Using network Socket
f0a85bca3128:84381:84577 [2] NCCL INFO Failed to open libibverbs.so[.1]
f0a85bca3128:84381:84577 [2] NCCL INFO NET/Socket : Using [0]eth0:172.17.0.2<0>
f0a85bca3128:84381:84577 [2] NCCL INFO Using non-device net plugin version 0
f0a85bca3128:84381:84577 [2] NCCL INFO Using network Socket
f0a85bca3128:84380:84578 [1] NCCL INFO Failed to open libibverbs.so[.1]
f0a85bca3128:84380:84578 [1] NCCL INFO NET/Socket : Using [0]eth0:172.17.0.2<0>
f0a85bca3128:84380:84578 [1] NCCL INFO Using non-device net plugin version 0
f0a85bca3128:84380:84578 [1] NCCL INFO Using network Socket
f0a85bca3128:84380:84578 [1] NCCL INFO ncclCommInitRank comm 0x563972347cf0 rank 1 nranks 3 cudaDev 1 nvmlDev 2 busId 81000 commId 0xe2a230ad3c81de21 - Init START
f0a85bca3128:84379:84574 [0] NCCL INFO ncclCommInitRank comm 0x563788b06860 rank 0 nranks 3 cudaDev 0 nvmlDev 1 busId 25000 commId 0xe2a230ad3c81de21 - Init START
f0a85bca3128:84381:84577 [2] NCCL INFO ncclCommInitRank comm 0x556613676df0 rank 2 nranks 3 cudaDev 2 nvmlDev 3 busId c1000 commId 0xe2a230ad3c81de21 - Init START
f0a85bca3128:84379:84574 [0] NCCL INFO Setting affinity for GPU 1 to ff0000,00000000,00ff0000
f0a85bca3128:84379:84574 [0] NCCL INFO NVLS multicast support is not available on dev 0
f0a85bca3128:84380:84578 [1] NCCL INFO Setting affinity for GPU 2 to ff000000,00000000,ff000000,00000000
f0a85bca3128:84381:84577 [2] NCCL INFO Setting affinity for GPU 3 to ff00,00000000,0000ff00,00000000
f0a85bca3128:84380:84578 [1] NCCL INFO NVLS multicast support is not available on dev 1
f0a85bca3128:84381:84577 [2] NCCL INFO NVLS multicast support is not available on dev 2
f0a85bca3128:84381:84577 [2] NCCL INFO comm 0x556613676df0 rank 2 nRanks 3 nNodes 1 localRanks 3 localRank 2 MNNVL 0
f0a85bca3128:84379:84574 [0] NCCL INFO comm 0x563788b06860 rank 0 nRanks 3 nNodes 1 localRanks 3 localRank 0 MNNVL 0
f0a85bca3128:84380:84578 [1] NCCL INFO comm 0x563972347cf0 rank 1 nRanks 3 nNodes 1 localRanks 3 localRank 1 MNNVL 0
f0a85bca3128:84381:84577 [2] NCCL INFO Trees [0] -1/-1/-1->2->1 [1] -1/-1/-1->2->1
f0a85bca3128:84380:84578 [1] NCCL INFO Trees [0] 2/-1/-1->1->0 [1] 2/-1/-1->1->0
f0a85bca3128:84381:84577 [2] NCCL INFO P2P Chunksize set to 524288
f0a85bca3128:84379:84574 [0] NCCL INFO Channel 00/02 :    0   1   2
f0a85bca3128:84380:84578 [1] NCCL INFO P2P Chunksize set to 524288
f0a85bca3128:84379:84574 [0] NCCL INFO Channel 01/02 :    0   1   2
f0a85bca3128:84379:84574 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1
f0a85bca3128:84379:84574 [0] NCCL INFO P2P Chunksize set to 524288
f0a85bca3128:84381:84577 [2] NCCL INFO Channel 00/0 : 2[3] -> 0[1] via P2P/CUMEM
f0a85bca3128:84381:84577 [2] NCCL INFO Channel 01/0 : 2[3] -> 0[1] via P2P/CUMEM
f0a85bca3128:84379:84574 [0] NCCL INFO Channel 00/0 : 0[1] -> 1[2] via P2P/CUMEM
f0a85bca3128:84380:84578 [1] NCCL INFO Channel 00/0 : 1[2] -> 2[3] via P2P/CUMEM
f0a85bca3128:84379:84574 [0] NCCL INFO Channel 01/0 : 0[1] -> 1[2] via P2P/CUMEM
f0a85bca3128:84380:84578 [1] NCCL INFO Channel 01/0 : 1[2] -> 2[3] via P2P/CUMEM
f0a85bca3128:84380:84578 [1] NCCL INFO Connected all rings
f0a85bca3128:84381:84577 [2] NCCL INFO Connected all rings
f0a85bca3128:84381:84577 [2] NCCL INFO Channel 00/0 : 2[3] -> 1[2] via P2P/CUMEM
f0a85bca3128:84379:84574 [0] NCCL INFO Connected all rings
f0a85bca3128:84381:84577 [2] NCCL INFO Channel 01/0 : 2[3] -> 1[2] via P2P/CUMEM
f0a85bca3128:84380:84578 [1] NCCL INFO Channel 00/0 : 1[2] -> 0[1] via P2P/CUMEM
f0a85bca3128:84380:84578 [1] NCCL INFO Channel 01/0 : 1[2] -> 0[1] via P2P/CUMEM
f0a85bca3128:84379:84574 [0] NCCL INFO Connected all trees
f0a85bca3128:84379:84574 [0] NCCL INFO threadThresholds 8/8/64 | 24/8/64 | 512 | 512
f0a85bca3128:84379:84574 [0] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
f0a85bca3128:84381:84577 [2] NCCL INFO Connected all trees
f0a85bca3128:84381:84577 [2] NCCL INFO threadThresholds 8/8/64 | 24/8/64 | 512 | 512
f0a85bca3128:84381:84577 [2] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
f0a85bca3128:84380:84578 [1] NCCL INFO Connected all trees
f0a85bca3128:84380:84578 [1] NCCL INFO threadThresholds 8/8/64 | 24/8/64 | 512 | 512
f0a85bca3128:84380:84578 [1] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
f0a85bca3128:84380:84578 [1] NCCL INFO TUNER/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-tuner.so
f0a85bca3128:84381:84577 [2] NCCL INFO TUNER/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-tuner.so
f0a85bca3128:84380:84578 [1] NCCL INFO TUNER/Plugin: Using internal tuner plugin.
f0a85bca3128:84381:84577 [2] NCCL INFO TUNER/Plugin: Using internal tuner plugin.
f0a85bca3128:84381:84577 [2] NCCL INFO ncclCommInitRank comm 0x556613676df0 rank 2 nranks 3 cudaDev 2 nvmlDev 3 busId c1000 commId 0xe2a230ad3c81de21 - Init COMPLETE
f0a85bca3128:84380:84578 [1] NCCL INFO ncclCommInitRank comm 0x563972347cf0 rank 1 nranks 3 cudaDev 1 nvmlDev 2 busId 81000 commId 0xe2a230ad3c81de21 - Init COMPLETE
f0a85bca3128:84379:84574 [0] NCCL INFO TUNER/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-tuner.so
f0a85bca3128:84379:84574 [0] NCCL INFO TUNER/Plugin: Using internal tuner plugin.
f0a85bca3128:84379:84574 [0] NCCL INFO ncclCommInitRank comm 0x563788b06860 rank 0 nranks 3 cudaDev 0 nvmlDev 1 busId 25000 commId 0xe2a230ad3c81de21 - Init COMPLETE

=== Calculating Dataset Statistics ===
Error: [Errno 2] No such file or directory: './data/reports/reports_sampled.csv'
f0a85bca3128:84379:84587 [0] NCCL INFO [Service thread] Connection closed by localRank 0
f0a85bca3128:84379:84630 [0] NCCL INFO comm 0x563788b06860 rank 0 nranks 3 cudaDev 0 busId 25000 - Abort COMPLETE
