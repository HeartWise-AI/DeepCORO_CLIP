pipeline_project: "DeepCORO_clip"
base_checkpoint_path: outputs
# Core run parameters
run_mode: train
epochs: 30
seed: 42
# WandB logging
name: "dev_deep_coro_clip_single_video"
project: "dev_deep_coro_clip_single_video"
entity: "mhi_ai"
tag: "dev_deep_coro_clip_single_video"
use_wandb: true
# Device settings (overridden at runtime when using torchrun)
device: 0
world_size: 1
is_ref_device: true
# Training parameters
lr: 7.214087700658924e-05
batch_size: 24
num_workers: 16
debug: false
temperature: 0.08703471467769354
max_grad_norm: 1.0
use_amp: true
period: 1
gradient_accumulation_steps: 1
max_length: 64
# Dataset parameters
data_filename: "/media/data1/ravram/DeepCORO_CLIP_ENCODER/datasets/reports_with_alpha_separator_with_Calcifc_Stenosis_IFR_20250601_RCA_LCA_merged_with_left_dominance_dependent_vessels.csv"
root: "."
study_metadata_path: "/media/data1/datasets/DeepCoro/2b_CathReport_HEMO_MHI_MERGED_2017-2024_STUDY_LEVEL.parquet"
metadata_path: "/media/data1/datasets/ECG_Tokenizer/utils/inference/reports_metadata.parquet"
text_embeddings_path: "/media/data1/datasets/ECG_Tokenizer/utils/inference/reports_embeddings.pt"
target_label: "Report"
datapoint_loc_label: "FileName"
frames: 16
stride: 1
multi_video: false
num_videos: 1
groupby_column: "StudyInstanceUID"
shuffle_videos: true
aggregate_videos_tokens: false
per_video_pool: false
# Model parameters
model_name: "mvit"
pretrained: true
video_freeze_ratio: 0.8006794008069684
text_freeze_ratio: 0.7464391999406222
dropout: 0.11443597301670493
num_heads: 16
aggregator_depth: 1
video_pooling_mode: "attention"
attention_pool_heads: 8
attention_pool_dropout: 0.1
learnable_temperature: true
max_logit_scale: 40.0
# Optimizer and scheduler
optimizer: "AdamW"
scheduler_name: "linear_warmup"
lr_step_period: 15
factor: 0.14617805853947136
video_weight_decay: 0.000010931731551842769
text_weight_decay: 1.1105191010748157e-07
num_warmup_percent: 0.05
num_hard_restarts_cycles: 1
warm_restart_tmult: 2
# Loss and metrics
loss_name: "siglip_ddp"
recall_k: [1, 5, 10, 50]
ndcg_k: [5]
# Data augmentation
rand_augment: true
resize: 224
apply_mask: false
# Checkpointing and evaluation
save_best: "loss"
resume_training: false
topk: 5
retrieval_fp16: true
checkpoint: "outputs/deepCORO_CLIP/DeepCORO_Clip_Sweep_Learnable_Temp_Full_mvit_b12_f16_RAdam_lr0.0001_20250114-190320_2o5xoevj/checkpoints/latest.pt"
inference_results_path: "checkpoints/inference/"
# Additional bookkeeping (optional metrics context)
train_dataset_size: 1830
val_dataset_size: 396
view_count: null
run_description: "Single-video report alignment configuration derived from dev sweep defaults."
