Base config: BaseConfig(epochs=20, num_workers=16, debug=False, data_filename='data/reports/reports_sampled_300_study_ids.csv', root='.', target_label='Report', datapoint_loc_label='FileName', frames=16, stride=2, multi_video=True, num_videos=4, groupby_column='StudyInstanceUID', shuffle_videos=True, model_name='mvit', pretrained=True, output_dir='outputs', seed=42, use_amp=True, device='cuda', period=1, recall_k=[1, 5, 10], ndcg_k=[5], rand_augment=True, resize=224, apply_mask=False, view_count=None, save_best='loss', resume_training=False, checkpoint='outputs/deepCORO_CLIP/DeepCORO_Clip_Sweep_Learnable_Temp_Full_mvit_b12_f16_RAdam_lr0.0001_20250114-190320_2o5xoevj/checkpoints/latest.pt', text_weight_decay=1e-05, video_weight_decay=0.0001)
Sweep config: SweepConfig(batch_size=10, lr=0.0009512672719315712, optimizer='RAdam', scheduler_type='cosine', lr_step_period=15, factor=0.3747468295119422, video_weight_decay=4.486405746324928e-07, text_weight_decay=7.031198272899145e-07, loss_name='contrastive', temperature=0.08305349533391036, dropout=0.13049221062349897, video_freeze_ratio=0.6656615454968181, text_freeze_ratio=0.8106566448543835, num_heads=4, aggregator_depth=1, tag='mvit_pretrained', name='dev_deep_coro_clip', project='dev_deep_coro_clip', entity='mhi_ai')
HeartWise config: HeartWiseConfig(lr=0.0009512672719315712, batch_size=10, epochs=20, num_workers=16, debug=False, temperature=0.08305349533391036, data_filename='data/reports/reports_sampled_300_study_ids.csv', root='.', target_label='Report', datapoint_loc_label='FileName', frames=16, stride=2, multi_video=True, num_videos=4, groupby_column='StudyInstanceUID', shuffle_videos=True, model_name='mvit', pretrained=True, video_freeze_ratio=0.6656615454968181, text_freeze_ratio=0.8106566448543835, dropout=0.13049221062349897, num_heads=4, aggregator_depth=1, optimizer='RAdam', scheduler_type='cosine', lr_step_period=15, factor=0.3747468295119422, video_weight_decay=4.486405746324928e-07, text_weight_decay=7.031198272899145e-07, output_dir='outputs', seed=42, use_amp=True, device='cuda', period=1, loss_name='contrastive', recall_k=[1, 5, 10], ndcg_k=[5], rand_augment=True, resize=224, apply_mask=False, view_count=None, save_best='loss', resume_training=False, checkpoint='outputs/deepCORO_CLIP/DeepCORO_Clip_Sweep_Learnable_Temp_Full_mvit_b12_f16_RAdam_lr0.0001_20250114-190320_2o5xoevj/checkpoints/latest.pt', tag='mvit_pretrained', name='dev_deep_coro_clip', project='dev_deep_coro_clip', entity='mhi_ai')
running main with gpu 0
Base config: BaseConfig(epochs=20, num_workers=16, debug=False, data_filename='data/reports/reports_sampled_300_study_ids.csv', root='.', target_label='Report', datapoint_loc_label='FileName', frames=16, stride=2, multi_video=True, num_videos=4, groupby_column='StudyInstanceUID', shuffle_videos=True, model_name='mvit', pretrained=True, output_dir='outputs', seed=42, use_amp=True, device='cuda', period=1, recall_k=[1, 5, 10], ndcg_k=[5], rand_augment=True, resize=224, apply_mask=False, view_count=None, save_best='loss', resume_training=False, checkpoint='outputs/deepCORO_CLIP/DeepCORO_Clip_Sweep_Learnable_Temp_Full_mvit_b12_f16_RAdam_lr0.0001_20250114-190320_2o5xoevj/checkpoints/latest.pt', text_weight_decay=1e-05, video_weight_decay=0.0001)
Sweep config: SweepConfig(batch_size=10, lr=0.0009512672719315712, optimizer='RAdam', scheduler_type='cosine', lr_step_period=15, factor=0.3747468295119422, video_weight_decay=4.486405746324928e-07, text_weight_decay=7.031198272899145e-07, loss_name='contrastive', temperature=0.08305349533391036, dropout=0.13049221062349897, video_freeze_ratio=0.6656615454968181, text_freeze_ratio=0.8106566448543835, num_heads=4, aggregator_depth=1, tag='mvit_pretrained', name='dev_deep_coro_clip', project='dev_deep_coro_clip', entity='mhi_ai')
HeartWise config: HeartWiseConfig(lr=0.0009512672719315712, batch_size=10, epochs=20, num_workers=16, debug=False, temperature=0.08305349533391036, data_filename='data/reports/reports_sampled_300_study_ids.csv', root='.', target_label='Report', datapoint_loc_label='FileName', frames=16, stride=2, multi_video=True, num_videos=4, groupby_column='StudyInstanceUID', shuffle_videos=True, model_name='mvit', pretrained=True, video_freeze_ratio=0.6656615454968181, text_freeze_ratio=0.8106566448543835, dropout=0.13049221062349897, num_heads=4, aggregator_depth=1, optimizer='RAdam', scheduler_type='cosine', lr_step_period=15, factor=0.3747468295119422, video_weight_decay=4.486405746324928e-07, text_weight_decay=7.031198272899145e-07, output_dir='outputs', seed=42, use_amp=True, device='cuda', period=1, loss_name='contrastive', recall_k=[1, 5, 10], ndcg_k=[5], rand_augment=True, resize=224, apply_mask=False, view_count=None, save_best='loss', resume_training=False, checkpoint='outputs/deepCORO_CLIP/DeepCORO_Clip_Sweep_Learnable_Temp_Full_mvit_b12_f16_RAdam_lr0.0001_20250114-190320_2o5xoevj/checkpoints/latest.pt', tag='mvit_pretrained', name='dev_deep_coro_clip', project='dev_deep_coro_clip', entity='mhi_ai')
running main with gpu 1
("Config: {'lr': 0.0009512672719315712, 'batch_size': 10, 'epochs': 20, "
 "'num_workers': 16, 'debug': False, 'temperature': 0.08305349533391036, "
 "'data_filename': 'data/reports/reports_sampled_300_study_ids.csv', 'root': "
 "'.', 'target_label': 'Report', 'datapoint_loc_label': 'FileName', 'frames': "
 "16, 'stride': 2, 'multi_video': True, 'num_videos': 4, 'groupby_column': "
 "'StudyInstanceUID', 'shuffle_videos': True, 'model_name': 'mvit', "
 "'pretrained': True, 'video_freeze_ratio': 0.6656615454968181, "
 "'text_freeze_ratio': 0.8106566448543835, 'dropout': 0.13049221062349897, "
 "'num_heads': 4, 'aggregator_depth': 1, 'optimizer': 'RAdam', "
 "'scheduler_type': 'cosine', 'lr_step_period': 15, 'factor': "
 "0.3747468295119422, 'video_weight_decay': 4.486405746324928e-07, "
 "'text_weight_decay': 7.031198272899145e-07, 'output_dir': 'outputs', 'seed': "
 "42, 'use_amp': True, 'device': 'cuda', 'period': 1, 'loss_name': "
 "'contrastive', 'recall_k': [1, 5, 10], 'ndcg_k': [5], 'rand_augment': True, "
 "'resize': 224, 'apply_mask': False, 'view_count': None, 'save_best': 'loss', "
 "'resume_training': False, 'checkpoint': "
 "'outputs/deepCORO_CLIP/DeepCORO_Clip_Sweep_Learnable_Temp_Full_mvit_b12_f16_RAdam_lr0.0001_20250114-190320_2o5xoevj/checkpoints/latest.pt', "
 "'tag': 'mvit_pretrained', 'name': 'dev_deep_coro_clip', 'project': "
 "'dev_deep_coro_clip', 'entity': 'mhi_ai'}")
f0a85bca3128:91268:91268 [0] NCCL INFO Bootstrap : Using eth0:172.17.0.2<0>
f0a85bca3128:91268:91268 [0] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
f0a85bca3128:91268:91268 [0] NCCL INFO NET/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-net.so
f0a85bca3128:91268:91268 [0] NCCL INFO NET/Plugin: Using internal network plugin.
f0a85bca3128:91268:91268 [0] NCCL INFO cudaDriverVersion 12040
NCCL version 2.21.5+cuda12.4
f0a85bca3128:91269:91269 [1] NCCL INFO cudaDriverVersion 12040
f0a85bca3128:91269:91269 [1] NCCL INFO Bootstrap : Using eth0:172.17.0.2<0>
f0a85bca3128:91269:91269 [1] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
f0a85bca3128:91269:91269 [1] NCCL INFO NET/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-net.so
f0a85bca3128:91269:91269 [1] NCCL INFO NET/Plugin: Using internal network plugin.
f0a85bca3128:91269:91338 [1] NCCL INFO Failed to open libibverbs.so[.1]
f0a85bca3128:91269:91338 [1] NCCL INFO NET/Socket : Using [0]eth0:172.17.0.2<0>
f0a85bca3128:91269:91338 [1] NCCL INFO Using non-device net plugin version 0
f0a85bca3128:91269:91338 [1] NCCL INFO Using network Socket
f0a85bca3128:91268:91337 [0] NCCL INFO Failed to open libibverbs.so[.1]
f0a85bca3128:91268:91337 [0] NCCL INFO NET/Socket : Using [0]eth0:172.17.0.2<0>
f0a85bca3128:91268:91337 [0] NCCL INFO Using non-device net plugin version 0
f0a85bca3128:91268:91337 [0] NCCL INFO Using network Socket
f0a85bca3128:91268:91337 [0] NCCL INFO ncclCommInitRank comm 0x55d64b503420 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 1000 commId 0x61d00e87b0ae8983 - Init START
f0a85bca3128:91269:91338 [1] NCCL INFO ncclCommInitRank comm 0x55d191537f20 rank 1 nranks 2 cudaDev 1 nvmlDev 1 busId 25000 commId 0x61d00e87b0ae8983 - Init START
f0a85bca3128:91268:91337 [0] NCCL INFO Setting affinity for GPU 0 to ff000000,00000000,ff000000
f0a85bca3128:91269:91338 [1] NCCL INFO Setting affinity for GPU 1 to ff0000,00000000,00ff0000
f0a85bca3128:91269:91338 [1] NCCL INFO comm 0x55d191537f20 rank 1 nRanks 2 nNodes 1 localRanks 2 localRank 1 MNNVL 0
f0a85bca3128:91268:91337 [0] NCCL INFO comm 0x55d64b503420 rank 0 nRanks 2 nNodes 1 localRanks 2 localRank 0 MNNVL 0
f0a85bca3128:91268:91337 [0] NCCL INFO Channel 00/02 :    0   1
f0a85bca3128:91268:91337 [0] NCCL INFO Channel 01/02 :    0   1
f0a85bca3128:91269:91338 [1] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] -1/-1/-1->1->0
f0a85bca3128:91269:91338 [1] NCCL INFO P2P Chunksize set to 131072
f0a85bca3128:91268:91337 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1
f0a85bca3128:91268:91337 [0] NCCL INFO P2P Chunksize set to 131072
f0a85bca3128:91269:91338 [1] NCCL INFO Channel 00/0 : 1[1] -> 0[0] via P2P/CUMEM
f0a85bca3128:91269:91338 [1] NCCL INFO Channel 01/0 : 1[1] -> 0[0] via P2P/CUMEM
f0a85bca3128:91268:91337 [0] NCCL INFO Channel 00/0 : 0[0] -> 1[1] via P2P/CUMEM
f0a85bca3128:91268:91337 [0] NCCL INFO Channel 01/0 : 0[0] -> 1[1] via P2P/CUMEM
f0a85bca3128:91268:91337 [0] NCCL INFO Connected all rings
f0a85bca3128:91268:91337 [0] NCCL INFO Connected all trees
f0a85bca3128:91269:91338 [1] NCCL INFO Connected all rings
f0a85bca3128:91269:91338 [1] NCCL INFO Connected all trees
f0a85bca3128:91269:91338 [1] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
f0a85bca3128:91269:91338 [1] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
f0a85bca3128:91268:91337 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
f0a85bca3128:91268:91337 [0] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
f0a85bca3128:91268:91337 [0] NCCL INFO TUNER/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-tuner.so
f0a85bca3128:91268:91337 [0] NCCL INFO TUNER/Plugin: Using internal tuner plugin.
f0a85bca3128:91268:91337 [0] NCCL INFO ncclCommInitRank comm 0x55d64b503420 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 1000 commId 0x61d00e87b0ae8983 - Init COMPLETE
f0a85bca3128:91269:91338 [1] NCCL INFO TUNER/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-tuner.so
f0a85bca3128:91269:91338 [1] NCCL INFO TUNER/Plugin: Using internal tuner plugin.
f0a85bca3128:91269:91338 [1] NCCL INFO ncclCommInitRank comm 0x55d191537f20 rank 1 nranks 2 cudaDev 1 nvmlDev 1 busId 25000 commId 0x61d00e87b0ae8983 - Init COMPLETE

=== Calculating Dataset Statistics ===
Frame count per video: 16

Dataset Statistics:
Mean: [114.5306625366211, 114.5306625366211, 114.5306625366211]
Std:  [36.459014892578125, 36.459014892578125, 36.459014892578125]
===========================

Rank: 0 - mean: tensor([114.5307, 114.5307, 114.5307]) - std: tensor([36.4590, 36.4590, 36.4590])
[MultiVideoDataset] resize=224
[MultiVideoDataset] mean=[114.5306625366211, 114.5306625366211, 114.5306625366211]
[MultiVideoDataset] std=[36.459014892578125, 36.459014892578125, 36.459014892578125]
[MultiVideoDataset] shuffle_videos=True
[MultiVideoDataset] seed=42
[MultiVideoDataset] seed=42 for random video sampling
Rank: 1 - mean: tensor([114.5307, 114.5307, 114.5307]) - std: tensor([36.4590, 36.4590, 36.4590])
[MultiVideoDataset] resize=224
[MultiVideoDataset] mean=[114.5306625366211, 114.5306625366211, 114.5306625366211]
[MultiVideoDataset] std=[36.459014892578125, 36.459014892578125, 36.459014892578125]
[MultiVideoDataset] shuffle_videos=True
[MultiVideoDataset] seed=42
[MultiVideoDataset] seed=42 for random video sampling
[MultiVideoDataset] Found 273 studies in split='train'
[MultiVideoDataset] Missing 0 studies in split='train'
[MultiVideoDataset] Found 273 studies in split='train'
[MultiVideoDataset] Missing 0 studies in split='train'
[MultiVideoDataset] resize=224
[MultiVideoDataset] mean=[114.5306625366211, 114.5306625366211, 114.5306625366211]
[MultiVideoDataset] std=[36.459014892578125, 36.459014892578125, 36.459014892578125]
[MultiVideoDataset] shuffle_videos=True
[MultiVideoDataset] seed=42
[MultiVideoDataset] seed=42 for random video sampling
[MultiVideoDataset] resize=224
[MultiVideoDataset] mean=[114.5306625366211, 114.5306625366211, 114.5306625366211]
[MultiVideoDataset] std=[36.459014892578125, 36.459014892578125, 36.459014892578125]
[MultiVideoDataset] shuffle_videos=True
[MultiVideoDataset] seed=42
[MultiVideoDataset] seed=42 for random video sampling
[MultiVideoDataset] Found 27 studies in split='val'
[MultiVideoDataset] Missing 0 studies in split='val'
[MultiVideoDataset] Found 27 studies in split='val'
[MultiVideoDataset] Missing 0 studies in split='val'

=== Dataset Information ===
Training:   13 batches per GPU
Validation: 2 batches per GPU
Total:      15 batches per GPU

Batch Size: 10
Training: 130 videos per GPU
Validation: 20 videos per GPU
Total: 150 videos per GPU
===========================

Saved 27 val texts to outputs/dev_deep_coro_clip/mvit_pretrained_mvit_b10_f16_RAdam_lr0.0009512672719315712_20250206-025029_5jmr24ai/val_texts.csv
[DEBUG rank=0] local_video_feats = torch.Size([130, 512]), local_text_feats = torch.Size([130, 512])
Error: name '_gather_tensor_along_batch' is not defined
[DEBUG rank=1] local_video_feats = torch.Size([130, 512]), local_text_feats = torch.Size([130, 512])
Error: name '_gather_tensor_along_batch' is not defined
f0a85bca3128:91269:91339 [1] NCCL INFO [Service thread] Connection closed by localRank 1
f0a85bca3128:91269:102935 [1] NCCL INFO comm 0x55d191537f20 rank 1 nranks 2 cudaDev 1 busId 25000 - Abort COMPLETE
Base config: BaseConfig(epochs=20, num_workers=16, debug=False, data_filename='data/reports/reports_sampled_300_study_ids.csv', root='.', target_label='Report', datapoint_loc_label='FileName', frames=16, stride=2, multi_video=True, num_videos=4, groupby_column='StudyInstanceUID', shuffle_videos=True, model_name='mvit', pretrained=True, output_dir='outputs', seed=42, use_amp=True, device='cuda', period=1, recall_k=[1, 5, 10], ndcg_k=[5], rand_augment=True, resize=224, apply_mask=False, view_count=None, save_best='loss', resume_training=False, checkpoint='outputs/deepCORO_CLIP/DeepCORO_Clip_Sweep_Learnable_Temp_Full_mvit_b12_f16_RAdam_lr0.0001_20250114-190320_2o5xoevj/checkpoints/latest.pt', text_weight_decay=1e-05, video_weight_decay=0.0001)
Sweep config: SweepConfig(batch_size=10, lr=8.24803351216979e-05, optimizer='RAdam', scheduler_type='cosine', lr_step_period=15, factor=0.2260101918549345, video_weight_decay=1.8504472418040857e-07, text_weight_decay=3.071057891445372e-07, loss_name='contrastive', temperature=0.09114212183562724, dropout=0.153669331637451, video_freeze_ratio=0.6202638780437526, text_freeze_ratio=0.9438664589688672, num_heads=2, aggregator_depth=2, tag='mvit_pretrained', name='dev_deep_coro_clip', project='dev_deep_coro_clip', entity='mhi_ai')
HeartWise config: HeartWiseConfig(lr=8.24803351216979e-05, batch_size=10, epochs=20, num_workers=16, debug=False, temperature=0.09114212183562724, data_filename='data/reports/reports_sampled_300_study_ids.csv', root='.', target_label='Report', datapoint_loc_label='FileName', frames=16, stride=2, multi_video=True, num_videos=4, groupby_column='StudyInstanceUID', shuffle_videos=True, model_name='mvit', pretrained=True, video_freeze_ratio=0.6202638780437526, text_freeze_ratio=0.9438664589688672, dropout=0.153669331637451, num_heads=2, aggregator_depth=2, optimizer='RAdam', scheduler_type='cosine', lr_step_period=15, factor=0.2260101918549345, video_weight_decay=1.8504472418040857e-07, text_weight_decay=3.071057891445372e-07, output_dir='outputs', seed=42, use_amp=True, device='cuda', period=1, loss_name='contrastive', recall_k=[1, 5, 10], ndcg_k=[5], rand_augment=True, resize=224, apply_mask=False, view_count=None, save_best='loss', resume_training=False, checkpoint='outputs/deepCORO_CLIP/DeepCORO_Clip_Sweep_Learnable_Temp_Full_mvit_b12_f16_RAdam_lr0.0001_20250114-190320_2o5xoevj/checkpoints/latest.pt', tag='mvit_pretrained', name='dev_deep_coro_clip', project='dev_deep_coro_clip', entity='mhi_ai')
running main with gpu 1
Base config: BaseConfig(epochs=20, num_workers=16, debug=False, data_filename='data/reports/reports_sampled_300_study_ids.csv', root='.', target_label='Report', datapoint_loc_label='FileName', frames=16, stride=2, multi_video=True, num_videos=4, groupby_column='StudyInstanceUID', shuffle_videos=True, model_name='mvit', pretrained=True, output_dir='outputs', seed=42, use_amp=True, device='cuda', period=1, recall_k=[1, 5, 10], ndcg_k=[5], rand_augment=True, resize=224, apply_mask=False, view_count=None, save_best='loss', resume_training=False, checkpoint='outputs/deepCORO_CLIP/DeepCORO_Clip_Sweep_Learnable_Temp_Full_mvit_b12_f16_RAdam_lr0.0001_20250114-190320_2o5xoevj/checkpoints/latest.pt', text_weight_decay=1e-05, video_weight_decay=0.0001)
Sweep config: SweepConfig(batch_size=10, lr=8.24803351216979e-05, optimizer='RAdam', scheduler_type='cosine', lr_step_period=15, factor=0.2260101918549345, video_weight_decay=1.8504472418040857e-07, text_weight_decay=3.071057891445372e-07, loss_name='contrastive', temperature=0.09114212183562724, dropout=0.153669331637451, video_freeze_ratio=0.6202638780437526, text_freeze_ratio=0.9438664589688672, num_heads=2, aggregator_depth=2, tag='mvit_pretrained', name='dev_deep_coro_clip', project='dev_deep_coro_clip', entity='mhi_ai')
HeartWise config: HeartWiseConfig(lr=8.24803351216979e-05, batch_size=10, epochs=20, num_workers=16, debug=False, temperature=0.09114212183562724, data_filename='data/reports/reports_sampled_300_study_ids.csv', root='.', target_label='Report', datapoint_loc_label='FileName', frames=16, stride=2, multi_video=True, num_videos=4, groupby_column='StudyInstanceUID', shuffle_videos=True, model_name='mvit', pretrained=True, video_freeze_ratio=0.6202638780437526, text_freeze_ratio=0.9438664589688672, dropout=0.153669331637451, num_heads=2, aggregator_depth=2, optimizer='RAdam', scheduler_type='cosine', lr_step_period=15, factor=0.2260101918549345, video_weight_decay=1.8504472418040857e-07, text_weight_decay=3.071057891445372e-07, output_dir='outputs', seed=42, use_amp=True, device='cuda', period=1, loss_name='contrastive', recall_k=[1, 5, 10], ndcg_k=[5], rand_augment=True, resize=224, apply_mask=False, view_count=None, save_best='loss', resume_training=False, checkpoint='outputs/deepCORO_CLIP/DeepCORO_Clip_Sweep_Learnable_Temp_Full_mvit_b12_f16_RAdam_lr0.0001_20250114-190320_2o5xoevj/checkpoints/latest.pt', tag='mvit_pretrained', name='dev_deep_coro_clip', project='dev_deep_coro_clip', entity='mhi_ai')
running main with gpu 0
("Config: {'lr': 8.24803351216979e-05, 'batch_size': 10, 'epochs': 20, "
 "'num_workers': 16, 'debug': False, 'temperature': 0.09114212183562724, "
 "'data_filename': 'data/reports/reports_sampled_300_study_ids.csv', 'root': "
 "'.', 'target_label': 'Report', 'datapoint_loc_label': 'FileName', 'frames': "
 "16, 'stride': 2, 'multi_video': True, 'num_videos': 4, 'groupby_column': "
 "'StudyInstanceUID', 'shuffle_videos': True, 'model_name': 'mvit', "
 "'pretrained': True, 'video_freeze_ratio': 0.6202638780437526, "
 "'text_freeze_ratio': 0.9438664589688672, 'dropout': 0.153669331637451, "
 "'num_heads': 2, 'aggregator_depth': 2, 'optimizer': 'RAdam', "
 "'scheduler_type': 'cosine', 'lr_step_period': 15, 'factor': "
 "0.2260101918549345, 'video_weight_decay': 1.8504472418040857e-07, "
 "'text_weight_decay': 3.071057891445372e-07, 'output_dir': 'outputs', 'seed': "
 "42, 'use_amp': True, 'device': 'cuda', 'period': 1, 'loss_name': "
 "'contrastive', 'recall_k': [1, 5, 10], 'ndcg_k': [5], 'rand_augment': True, "
 "'resize': 224, 'apply_mask': False, 'view_count': None, 'save_best': 'loss', "
 "'resume_training': False, 'checkpoint': "
 "'outputs/deepCORO_CLIP/DeepCORO_Clip_Sweep_Learnable_Temp_Full_mvit_b12_f16_RAdam_lr0.0001_20250114-190320_2o5xoevj/checkpoints/latest.pt', "
 "'tag': 'mvit_pretrained', 'name': 'dev_deep_coro_clip', 'project': "
 "'dev_deep_coro_clip', 'entity': 'mhi_ai'}")
f0a85bca3128:102939:102939 [0] NCCL INFO Bootstrap : Using eth0:172.17.0.2<0>
f0a85bca3128:102939:102939 [0] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
f0a85bca3128:102939:102939 [0] NCCL INFO NET/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-net.so
f0a85bca3128:102939:102939 [0] NCCL INFO NET/Plugin: Using internal network plugin.
f0a85bca3128:102939:102939 [0] NCCL INFO cudaDriverVersion 12040
NCCL version 2.21.5+cuda12.4
f0a85bca3128:102940:102940 [1] NCCL INFO cudaDriverVersion 12040
f0a85bca3128:102940:102940 [1] NCCL INFO Bootstrap : Using eth0:172.17.0.2<0>
f0a85bca3128:102940:102940 [1] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
f0a85bca3128:102940:102940 [1] NCCL INFO NET/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-net.so
f0a85bca3128:102940:102940 [1] NCCL INFO NET/Plugin: Using internal network plugin.
f0a85bca3128:102939:103006 [0] NCCL INFO Failed to open libibverbs.so[.1]
f0a85bca3128:102939:103006 [0] NCCL INFO NET/Socket : Using [0]eth0:172.17.0.2<0>
f0a85bca3128:102939:103006 [0] NCCL INFO Using non-device net plugin version 0
f0a85bca3128:102939:103006 [0] NCCL INFO Using network Socket
f0a85bca3128:102940:103007 [1] NCCL INFO Failed to open libibverbs.so[.1]
f0a85bca3128:102940:103007 [1] NCCL INFO NET/Socket : Using [0]eth0:172.17.0.2<0>
f0a85bca3128:102940:103007 [1] NCCL INFO Using non-device net plugin version 0
f0a85bca3128:102940:103007 [1] NCCL INFO Using network Socket
f0a85bca3128:102939:103006 [0] NCCL INFO ncclCommInitRank comm 0x55b694d68dc0 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 1000 commId 0xecffd7babc641cbf - Init START
f0a85bca3128:102940:103007 [1] NCCL INFO ncclCommInitRank comm 0x55ed2ef746d0 rank 1 nranks 2 cudaDev 1 nvmlDev 1 busId 25000 commId 0xecffd7babc641cbf - Init START
f0a85bca3128:102940:103007 [1] NCCL INFO Setting affinity for GPU 1 to ff0000,00000000,00ff0000
f0a85bca3128:102939:103006 [0] NCCL INFO Setting affinity for GPU 0 to ff000000,00000000,ff000000
f0a85bca3128:102939:103006 [0] NCCL INFO comm 0x55b694d68dc0 rank 0 nRanks 2 nNodes 1 localRanks 2 localRank 0 MNNVL 0
f0a85bca3128:102939:103006 [0] NCCL INFO Channel 00/02 :    0   1
f0a85bca3128:102939:103006 [0] NCCL INFO Channel 01/02 :    0   1
f0a85bca3128:102940:103007 [1] NCCL INFO comm 0x55ed2ef746d0 rank 1 nRanks 2 nNodes 1 localRanks 2 localRank 1 MNNVL 0
f0a85bca3128:102939:103006 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1
f0a85bca3128:102939:103006 [0] NCCL INFO P2P Chunksize set to 131072
f0a85bca3128:102940:103007 [1] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] -1/-1/-1->1->0
f0a85bca3128:102940:103007 [1] NCCL INFO P2P Chunksize set to 131072
f0a85bca3128:102939:103006 [0] NCCL INFO Channel 00/0 : 0[0] -> 1[1] via P2P/CUMEM
f0a85bca3128:102939:103006 [0] NCCL INFO Channel 01/0 : 0[0] -> 1[1] via P2P/CUMEM
f0a85bca3128:102940:103007 [1] NCCL INFO Channel 00/0 : 1[1] -> 0[0] via P2P/CUMEM
f0a85bca3128:102940:103007 [1] NCCL INFO Channel 01/0 : 1[1] -> 0[0] via P2P/CUMEM
f0a85bca3128:102939:103006 [0] NCCL INFO Connected all rings
f0a85bca3128:102939:103006 [0] NCCL INFO Connected all trees
f0a85bca3128:102940:103007 [1] NCCL INFO Connected all rings
f0a85bca3128:102940:103007 [1] NCCL INFO Connected all trees
f0a85bca3128:102940:103007 [1] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
f0a85bca3128:102940:103007 [1] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
f0a85bca3128:102939:103006 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
f0a85bca3128:102939:103006 [0] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
f0a85bca3128:102939:103006 [0] NCCL INFO TUNER/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-tuner.so
f0a85bca3128:102939:103006 [0] NCCL INFO TUNER/Plugin: Using internal tuner plugin.
f0a85bca3128:102939:103006 [0] NCCL INFO ncclCommInitRank comm 0x55b694d68dc0 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 1000 commId 0xecffd7babc641cbf - Init COMPLETE
f0a85bca3128:102940:103007 [1] NCCL INFO TUNER/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-tuner.so
f0a85bca3128:102940:103007 [1] NCCL INFO TUNER/Plugin: Using internal tuner plugin.
f0a85bca3128:102940:103007 [1] NCCL INFO ncclCommInitRank comm 0x55ed2ef746d0 rank 1 nranks 2 cudaDev 1 nvmlDev 1 busId 25000 commId 0xecffd7babc641cbf - Init COMPLETE

=== Calculating Dataset Statistics ===
Frame count per video: 16

Dataset Statistics:
Mean: [114.5306625366211, 114.5306625366211, 114.5306625366211]
Std:  [36.459014892578125, 36.459014892578125, 36.459014892578125]
===========================

Rank: 0 - mean: tensor([114.5307, 114.5307, 114.5307]) - std: tensor([36.4590, 36.4590, 36.4590])
[MultiVideoDataset] resize=224
[MultiVideoDataset] mean=[114.5306625366211, 114.5306625366211, 114.5306625366211]
[MultiVideoDataset] std=[36.459014892578125, 36.459014892578125, 36.459014892578125]
[MultiVideoDataset] shuffle_videos=True
[MultiVideoDataset] seed=42
[MultiVideoDataset] seed=42 for random video sampling
Rank: 1 - mean: tensor([114.5307, 114.5307, 114.5307]) - std: tensor([36.4590, 36.4590, 36.4590])
[MultiVideoDataset] resize=224
[MultiVideoDataset] mean=[114.5306625366211, 114.5306625366211, 114.5306625366211]
[MultiVideoDataset] std=[36.459014892578125, 36.459014892578125, 36.459014892578125]
[MultiVideoDataset] shuffle_videos=True
[MultiVideoDataset] seed=42
[MultiVideoDataset] seed=42 for random video sampling
[MultiVideoDataset] Found 273 studies in split='train'[MultiVideoDataset] Found 273 studies in split='train'
[MultiVideoDataset] Missing 0 studies in split='train'

[MultiVideoDataset] Missing 0 studies in split='train'
[MultiVideoDataset] resize=224
[MultiVideoDataset] mean=[114.5306625366211, 114.5306625366211, 114.5306625366211]
[MultiVideoDataset] std=[36.459014892578125, 36.459014892578125, 36.459014892578125]
[MultiVideoDataset] shuffle_videos=True
[MultiVideoDataset] seed=42
[MultiVideoDataset] seed=42 for random video sampling
[MultiVideoDataset] Found 27 studies in split='val'
[MultiVideoDataset] Missing 0 studies in split='val'
[MultiVideoDataset] resize=224
[MultiVideoDataset] mean=[114.5306625366211, 114.5306625366211, 114.5306625366211]
[MultiVideoDataset] std=[36.459014892578125, 36.459014892578125, 36.459014892578125]
[MultiVideoDataset] shuffle_videos=True
[MultiVideoDataset] seed=42
[MultiVideoDataset] seed=42 for random video sampling
[MultiVideoDataset] Found 27 studies in split='val'
[MultiVideoDataset] Missing 0 studies in split='val'

=== Dataset Information ===
Training:   13 batches per GPU
Validation: 2 batches per GPU
Total:      15 batches per GPU

Batch Size: 10
Training: 130 videos per GPU
Validation: 20 videos per GPU
Total: 150 videos per GPU
===========================

Saved 27 val texts to outputs/dev_deep_coro_clip/mvit_pretrained_mvit_b10_f16_RAdam_lr8.24803351216979e-05_20250206-025155_fmd58x5p/val_texts.csv
[DEBUG rank=0] local_video_feats = torch.Size([130, 512]), local_text_feats = torch.Size([130, 512])
Error: name '_gather_tensor_along_batch' is not defined
[DEBUG rank=1] local_video_feats = torch.Size([130, 512]), local_text_feats = torch.Size([130, 512])
Error: name '_gather_tensor_along_batch' is not defined
f0a85bca3128:102940:103012 [1] NCCL INFO [Service thread] Connection closed by localRank 1
f0a85bca3128:102940:114635 [1] NCCL INFO comm 0x55ed2ef746d0 rank 1 nranks 2 cudaDev 1 busId 25000 - Abort COMPLETE
f0a85bca3128:102939:103010 [0] NCCL INFO [Service thread] Connection closed by localRank 0
Base config: BaseConfig(epochs=20, num_workers=16, debug=False, data_filename='data/reports/reports_sampled_300_study_ids.csv', root='.', target_label='Report', datapoint_loc_label='FileName', frames=16, stride=2, multi_video=True, num_videos=4, groupby_column='StudyInstanceUID', shuffle_videos=True, model_name='mvit', pretrained=True, output_dir='outputs', seed=42, use_amp=True, device='cuda', period=1, recall_k=[1, 5, 10], ndcg_k=[5], rand_augment=True, resize=224, apply_mask=False, view_count=None, save_best='loss', resume_training=False, checkpoint='outputs/deepCORO_CLIP/DeepCORO_Clip_Sweep_Learnable_Temp_Full_mvit_b12_f16_RAdam_lr0.0001_20250114-190320_2o5xoevj/checkpoints/latest.pt', text_weight_decay=1e-05, video_weight_decay=0.0001)
Sweep config: SweepConfig(batch_size=10, lr=8.500212978232303e-05, optimizer='AdamW', scheduler_type='cosine', lr_step_period=10, factor=0.21079586668007785, video_weight_decay=2.328817203388339e-06, text_weight_decay=9.630342937693127e-07, loss_name='contrastive', temperature=0.08044746724845502, dropout=0.143356405546905, video_freeze_ratio=0.7390946283225892, text_freeze_ratio=0.779610850892883, num_heads=2, aggregator_depth=2, tag='mvit_pretrained', name='dev_deep_coro_clip', project='dev_deep_coro_clip', entity='mhi_ai')
HeartWise config: HeartWiseConfig(lr=8.500212978232303e-05, batch_size=10, epochs=20, num_workers=16, debug=False, temperature=0.08044746724845502, data_filename='data/reports/reports_sampled_300_study_ids.csv', root='.', target_label='Report', datapoint_loc_label='FileName', frames=16, stride=2, multi_video=True, num_videos=4, groupby_column='StudyInstanceUID', shuffle_videos=True, model_name='mvit', pretrained=True, video_freeze_ratio=0.7390946283225892, text_freeze_ratio=0.779610850892883, dropout=0.143356405546905, num_heads=2, aggregator_depth=2, optimizer='AdamW', scheduler_type='cosine', lr_step_period=10, factor=0.21079586668007785, video_weight_decay=2.328817203388339e-06, text_weight_decay=9.630342937693127e-07, output_dir='outputs', seed=42, use_amp=True, device='cuda', period=1, loss_name='contrastive', recall_k=[1, 5, 10], ndcg_k=[5], rand_augment=True, resize=224, apply_mask=False, view_count=None, save_best='loss', resume_training=False, checkpoint='outputs/deepCORO_CLIP/DeepCORO_Clip_Sweep_Learnable_Temp_Full_mvit_b12_f16_RAdam_lr0.0001_20250114-190320_2o5xoevj/checkpoints/latest.pt', tag='mvit_pretrained', name='dev_deep_coro_clip', project='dev_deep_coro_clip', entity='mhi_ai')
running main with gpu 1
Base config: BaseConfig(epochs=20, num_workers=16, debug=False, data_filename='data/reports/reports_sampled_300_study_ids.csv', root='.', target_label='Report', datapoint_loc_label='FileName', frames=16, stride=2, multi_video=True, num_videos=4, groupby_column='StudyInstanceUID', shuffle_videos=True, model_name='mvit', pretrained=True, output_dir='outputs', seed=42, use_amp=True, device='cuda', period=1, recall_k=[1, 5, 10], ndcg_k=[5], rand_augment=True, resize=224, apply_mask=False, view_count=None, save_best='loss', resume_training=False, checkpoint='outputs/deepCORO_CLIP/DeepCORO_Clip_Sweep_Learnable_Temp_Full_mvit_b12_f16_RAdam_lr0.0001_20250114-190320_2o5xoevj/checkpoints/latest.pt', text_weight_decay=1e-05, video_weight_decay=0.0001)
Sweep config: SweepConfig(batch_size=10, lr=8.500212978232303e-05, optimizer='AdamW', scheduler_type='cosine', lr_step_period=10, factor=0.21079586668007785, video_weight_decay=2.328817203388339e-06, text_weight_decay=9.630342937693127e-07, loss_name='contrastive', temperature=0.08044746724845502, dropout=0.143356405546905, video_freeze_ratio=0.7390946283225892, text_freeze_ratio=0.779610850892883, num_heads=2, aggregator_depth=2, tag='mvit_pretrained', name='dev_deep_coro_clip', project='dev_deep_coro_clip', entity='mhi_ai')
HeartWise config: HeartWiseConfig(lr=8.500212978232303e-05, batch_size=10, epochs=20, num_workers=16, debug=False, temperature=0.08044746724845502, data_filename='data/reports/reports_sampled_300_study_ids.csv', root='.', target_label='Report', datapoint_loc_label='FileName', frames=16, stride=2, multi_video=True, num_videos=4, groupby_column='StudyInstanceUID', shuffle_videos=True, model_name='mvit', pretrained=True, video_freeze_ratio=0.7390946283225892, text_freeze_ratio=0.779610850892883, dropout=0.143356405546905, num_heads=2, aggregator_depth=2, optimizer='AdamW', scheduler_type='cosine', lr_step_period=10, factor=0.21079586668007785, video_weight_decay=2.328817203388339e-06, text_weight_decay=9.630342937693127e-07, output_dir='outputs', seed=42, use_amp=True, device='cuda', period=1, loss_name='contrastive', recall_k=[1, 5, 10], ndcg_k=[5], rand_augment=True, resize=224, apply_mask=False, view_count=None, save_best='loss', resume_training=False, checkpoint='outputs/deepCORO_CLIP/DeepCORO_Clip_Sweep_Learnable_Temp_Full_mvit_b12_f16_RAdam_lr0.0001_20250114-190320_2o5xoevj/checkpoints/latest.pt', tag='mvit_pretrained', name='dev_deep_coro_clip', project='dev_deep_coro_clip', entity='mhi_ai')
running main with gpu 0
("Config: {'lr': 8.500212978232303e-05, 'batch_size': 10, 'epochs': 20, "
 "'num_workers': 16, 'debug': False, 'temperature': 0.08044746724845502, "
 "'data_filename': 'data/reports/reports_sampled_300_study_ids.csv', 'root': "
 "'.', 'target_label': 'Report', 'datapoint_loc_label': 'FileName', 'frames': "
 "16, 'stride': 2, 'multi_video': True, 'num_videos': 4, 'groupby_column': "
 "'StudyInstanceUID', 'shuffle_videos': True, 'model_name': 'mvit', "
 "'pretrained': True, 'video_freeze_ratio': 0.7390946283225892, "
 "'text_freeze_ratio': 0.779610850892883, 'dropout': 0.143356405546905, "
 "'num_heads': 2, 'aggregator_depth': 2, 'optimizer': 'AdamW', "
 "'scheduler_type': 'cosine', 'lr_step_period': 10, 'factor': "
 "0.21079586668007785, 'video_weight_decay': 2.328817203388339e-06, "
 "'text_weight_decay': 9.630342937693127e-07, 'output_dir': 'outputs', 'seed': "
 "42, 'use_amp': True, 'device': 'cuda', 'period': 1, 'loss_name': "
 "'contrastive', 'recall_k': [1, 5, 10], 'ndcg_k': [5], 'rand_augment': True, "
 "'resize': 224, 'apply_mask': False, 'view_count': None, 'save_best': 'loss', "
 "'resume_training': False, 'checkpoint': "
 "'outputs/deepCORO_CLIP/DeepCORO_Clip_Sweep_Learnable_Temp_Full_mvit_b12_f16_RAdam_lr0.0001_20250114-190320_2o5xoevj/checkpoints/latest.pt', "
 "'tag': 'mvit_pretrained', 'name': 'dev_deep_coro_clip', 'project': "
 "'dev_deep_coro_clip', 'entity': 'mhi_ai'}")
f0a85bca3128:114640:114640 [0] NCCL INFO Bootstrap : Using eth0:172.17.0.2<0>
f0a85bca3128:114640:114640 [0] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
f0a85bca3128:114640:114640 [0] NCCL INFO NET/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-net.so
f0a85bca3128:114640:114640 [0] NCCL INFO NET/Plugin: Using internal network plugin.
f0a85bca3128:114640:114640 [0] NCCL INFO cudaDriverVersion 12040
NCCL version 2.21.5+cuda12.4
f0a85bca3128:114641:114641 [1] NCCL INFO cudaDriverVersion 12040
f0a85bca3128:114641:114641 [1] NCCL INFO Bootstrap : Using eth0:172.17.0.2<0>
f0a85bca3128:114641:114641 [1] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
f0a85bca3128:114641:114641 [1] NCCL INFO NET/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-net.so
f0a85bca3128:114641:114641 [1] NCCL INFO NET/Plugin: Using internal network plugin.
f0a85bca3128:114640:114707 [0] NCCL INFO Failed to open libibverbs.so[.1]
f0a85bca3128:114640:114707 [0] NCCL INFO NET/Socket : Using [0]eth0:172.17.0.2<0>
f0a85bca3128:114640:114707 [0] NCCL INFO Using non-device net plugin version 0
f0a85bca3128:114640:114707 [0] NCCL INFO Using network Socket
f0a85bca3128:114641:114708 [1] NCCL INFO Failed to open libibverbs.so[.1]
f0a85bca3128:114641:114708 [1] NCCL INFO NET/Socket : Using [0]eth0:172.17.0.2<0>
f0a85bca3128:114641:114708 [1] NCCL INFO Using non-device net plugin version 0
f0a85bca3128:114641:114708 [1] NCCL INFO Using network Socket
f0a85bca3128:114641:114708 [1] NCCL INFO ncclCommInitRank comm 0x55995960a4a0 rank 1 nranks 2 cudaDev 1 nvmlDev 1 busId 25000 commId 0x220ddc5c314fdfa3 - Init START
f0a85bca3128:114640:114707 [0] NCCL INFO ncclCommInitRank comm 0x560f68ffc080 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 1000 commId 0x220ddc5c314fdfa3 - Init START
f0a85bca3128:114641:114708 [1] NCCL INFO Setting affinity for GPU 1 to ff0000,00000000,00ff0000
f0a85bca3128:114640:114707 [0] NCCL INFO Setting affinity for GPU 0 to ff000000,00000000,ff000000
f0a85bca3128:114641:114708 [1] NCCL INFO comm 0x55995960a4a0 rank 1 nRanks 2 nNodes 1 localRanks 2 localRank 1 MNNVL 0
f0a85bca3128:114640:114707 [0] NCCL INFO comm 0x560f68ffc080 rank 0 nRanks 2 nNodes 1 localRanks 2 localRank 0 MNNVL 0
f0a85bca3128:114640:114707 [0] NCCL INFO Channel 00/02 :    0   1
f0a85bca3128:114640:114707 [0] NCCL INFO Channel 01/02 :    0   1
f0a85bca3128:114641:114708 [1] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] -1/-1/-1->1->0
f0a85bca3128:114641:114708 [1] NCCL INFO P2P Chunksize set to 131072
f0a85bca3128:114640:114707 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1
f0a85bca3128:114640:114707 [0] NCCL INFO P2P Chunksize set to 131072
f0a85bca3128:114641:114708 [1] NCCL INFO Channel 00/0 : 1[1] -> 0[0] via P2P/CUMEM
f0a85bca3128:114640:114707 [0] NCCL INFO Channel 00/0 : 0[0] -> 1[1] via P2P/CUMEM
f0a85bca3128:114641:114708 [1] NCCL INFO Channel 01/0 : 1[1] -> 0[0] via P2P/CUMEM
f0a85bca3128:114640:114707 [0] NCCL INFO Channel 01/0 : 0[0] -> 1[1] via P2P/CUMEM
f0a85bca3128:114641:114708 [1] NCCL INFO Connected all rings
f0a85bca3128:114641:114708 [1] NCCL INFO Connected all trees
f0a85bca3128:114640:114707 [0] NCCL INFO Connected all rings
f0a85bca3128:114641:114708 [1] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
f0a85bca3128:114641:114708 [1] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
f0a85bca3128:114640:114707 [0] NCCL INFO Connected all trees
f0a85bca3128:114640:114707 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
f0a85bca3128:114640:114707 [0] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
f0a85bca3128:114641:114708 [1] NCCL INFO TUNER/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-tuner.so
f0a85bca3128:114641:114708 [1] NCCL INFO TUNER/Plugin: Using internal tuner plugin.
f0a85bca3128:114641:114708 [1] NCCL INFO ncclCommInitRank comm 0x55995960a4a0 rank 1 nranks 2 cudaDev 1 nvmlDev 1 busId 25000 commId 0x220ddc5c314fdfa3 - Init COMPLETE
f0a85bca3128:114640:114707 [0] NCCL INFO TUNER/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-tuner.so
f0a85bca3128:114640:114707 [0] NCCL INFO TUNER/Plugin: Using internal tuner plugin.
f0a85bca3128:114640:114707 [0] NCCL INFO ncclCommInitRank comm 0x560f68ffc080 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 1000 commId 0x220ddc5c314fdfa3 - Init COMPLETE

=== Calculating Dataset Statistics ===
Frame count per video: 16

Dataset Statistics:
Mean: [114.5306625366211, 114.5306625366211, 114.5306625366211]
Std:  [36.459014892578125, 36.459014892578125, 36.459014892578125]
===========================

Rank: 0 - mean: tensor([114.5307, 114.5307, 114.5307]) - std: tensor([36.4590, 36.4590, 36.4590])
[MultiVideoDataset] resize=224
[MultiVideoDataset] mean=[114.5306625366211, 114.5306625366211, 114.5306625366211]
[MultiVideoDataset] std=[36.459014892578125, 36.459014892578125, 36.459014892578125]
[MultiVideoDataset] shuffle_videos=True
[MultiVideoDataset] seed=42
[MultiVideoDataset] seed=42 for random video sampling
Rank: 1 - mean: tensor([114.5307, 114.5307, 114.5307]) - std: tensor([36.4590, 36.4590, 36.4590])
[MultiVideoDataset] resize=224
[MultiVideoDataset] mean=[114.5306625366211, 114.5306625366211, 114.5306625366211]
[MultiVideoDataset] std=[36.459014892578125, 36.459014892578125, 36.459014892578125]
[MultiVideoDataset] shuffle_videos=True
[MultiVideoDataset] seed=42
[MultiVideoDataset] seed=42 for random video sampling
[MultiVideoDataset] Found 273 studies in split='train'[MultiVideoDataset] Found 273 studies in split='train'
[MultiVideoDataset] Missing 0 studies in split='train'

[MultiVideoDataset] Missing 0 studies in split='train'
[MultiVideoDataset] resize=224
[MultiVideoDataset] mean=[114.5306625366211, 114.5306625366211, 114.5306625366211]
[MultiVideoDataset] std=[36.459014892578125, 36.459014892578125, 36.459014892578125]
[MultiVideoDataset] shuffle_videos=True
[MultiVideoDataset] seed=42
[MultiVideoDataset] seed=42 for random video sampling
[MultiVideoDataset] resize=224
[MultiVideoDataset] mean=[114.5306625366211, 114.5306625366211, 114.5306625366211]
[MultiVideoDataset] std=[36.459014892578125, 36.459014892578125, 36.459014892578125]
[MultiVideoDataset] shuffle_videos=True
[MultiVideoDataset] seed=42
[MultiVideoDataset] seed=42 for random video sampling
[MultiVideoDataset] Found 27 studies in split='val'
[MultiVideoDataset] Missing 0 studies in split='val'
[MultiVideoDataset] Found 27 studies in split='val'
[MultiVideoDataset] Missing 0 studies in split='val'

=== Dataset Information ===
Training:   13 batches per GPU
Validation: 2 batches per GPU
Total:      15 batches per GPU

Batch Size: 10
Training: 130 videos per GPU
Validation: 20 videos per GPU
Total: 150 videos per GPU
===========================

Saved 27 val texts to outputs/dev_deep_coro_clip/mvit_pretrained_mvit_b10_f16_AdamW_lr8.500212978232303e-05_20250206-025317_h1varoid/val_texts.csv
[DEBUG rank=1] local_video_feats = torch.Size([130, 512]), local_text_feats = torch.Size([130, 512])
Error: name '_gather_tensor_along_batch' is not defined
f0a85bca3128:114641:114712 [1] NCCL INFO [Service thread] Connection closed by localRank 1
[DEBUG rank=0] local_video_feats = torch.Size([130, 512]), local_text_feats = torch.Size([130, 512])
Error: name '_gather_tensor_along_batch' is not defined
f0a85bca3128:114641:126283 [1] NCCL INFO comm 0x55995960a4a0 rank 1 nranks 2 cudaDev 1 busId 25000 - Abort COMPLETE
f0a85bca3128:114640:114711 [0] NCCL INFO [Service thread] Connection closed by localRank 0
